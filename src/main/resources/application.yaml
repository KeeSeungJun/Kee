
# Spring boot info
spring:

  main:
    allow-bean-definition-overriding: true

  autoconfigure:
    exclude:
      - org.springframework.boot.jdbc.autoconfigure.metrics.DataSourcePoolMetricsAutoConfiguration

  application:
    name: '@artifactId@'

  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://seonior.cduwe6oii7rg.ap-southeast-2.rds.amazonaws.com:3306/jobdb?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8
    username: admin
    password: "admin1234!"
    hikari:
      minimum-idle: 2
      maximum-pool-size: 5

#   datasource:
# #    driver-class-name: org.mariadb.jdbc.Driver
# #    url: jdbc:mariadb://localhost:3306/seonier
#     driver-class-name: org.h2.Driver
#     url: jdbc:h2:file:~/H2/seonier;MODE=MySQL;DB_CLOSE_DELAY=-1;INIT=RUNSCRIPT FROM 'classpath:db/schema.sql';
#     username: sa
#     password:
#     hikari:
#       minimum-idle: 2
#       maximum-pool-size: 5

#   h2:
#     console:
#       enabled: true
#       path: /h2/console

#  config:
#    import:
#      - optional:file:/opt/app-root/etc/conf/application-external.yaml
  profiles:
    group:
      dev: dev
      stage: stage
      prod: prod

  thymeleaf:
    cache: false
#    mode: HTML5

  web:
    resources:
      add-mappings: false
  ai:
    openai:
      api-key: ENC(pif1sV53mh2HAJtkZodCV/84zMmvwnG0gVfjH1+NJj624x6JINpYIH//3HiFT7axu39V06D10H7u3kWT1hAXFigI2Zu7O9jCWcT0Nd09sDlDI0JbfKukNGifc53IQygL3EWuHRmyp2PlaYvAPkEdJGBJRio0M4J71prAyTlyqc+mpy4aH63HXgbSPpvf0YPGxyg6aCPqC37LkK0DVbx75zEUyPCzc/BRtlOLKuhz0W/ssdkkPay+UHfPavF2AM+ulmpPb9j2ZPY9eY9LUMBjrw==)

  # 이메일 설정
  mail:
    host: smtp.gmail.com
    port: 587
    username: kikee22022@gmail.com  # Gmail 주소로 변경 필요
    password: nqoe ogss vwjh lhpz      # Gmail 앱 비밀번호로 변경 필요
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
    default-encoding: UTF-8

# Mybatis 설정
mybatis:
  config-location: classpath:com/seonier/persistence/mybatis-config.xml
  mapper-locations: classpath:com/seonier/persistence/mapper/**/*.xml
  type-aliases-package: com.seonier.dto.request,seonier.kt.dto.response,com.seonier.persistence.model

# Server info
server:
  compression:
    enabled: true
  error:
    include-binding-errors: never
    include-exception: false
    include-message: never
    include-stacktrace: never
    page: /error
    whitelabel:
      enabled: false
  port: 8080
  servlet:
    context-path: '/'
  shutdown: graceful

  tomcat:
    additional-tld-skip-patterns: '*.jar'

# Actuator properties
management:
  endpoint:
    env:
      show-values: always
  endpoints:
    web:
      base-path: /actuator
      exposure:
        include:
          - env
          - health
          - info
  health:
    livenessState:
      enabled: true
    readinessState:
      enabled: true
  info:
    env:
      enabled: true

# Application info
info:
  app:
    env:          '${spring.profiles.active:@env@}'
    group:        '@groupId@'
    artifact:     '@artifactId@'
    version:      '@version@'
    name:         '@name@'
    description:  '@description@'

# KakaoMap API 설정
kakao:
  api:
    key: 5fb5295e30fefa1e5093d1382420b2e9  # Kakao REST API 키
    javascript-key: 5fb5295e30fefa1e5093d1382420b2e9  # Kakao JavaScript API 키 (동일한 키 사용 가능)

prompt: |
  너는 사용자의 건강상태, 희망 급여, 연령, 직업 이력, 주거지 위치 등을 고려해 아래 일자리 중 적합한 일자리 30개를 추천하는 평가 모델이야.
  
  **점수 계산 기준 (엄격하게 적용):**
  - 90점 이상: 모든 조건이 완벽하게 일치하고 추천 사유가 명확한 경우만 부여
  - 80-89점: 대부분의 조건이 잘 맞으나 1-2가지 소소한 불일치가 있는 경우
  - 70-79점: 기본 조건은 맞지만 여러 가지 개선이 필요한 경우
  - 60-69점: 조건이 부분적으로만 일치하는 경우
  - 60점 미만: 조건이 맞지 않거나 추천이 적절하지 않은 경우
  
  **점수 산정 시 주의사항:**
  1. 근무시간: 사용자 연령과 건강상태를 고려한 적정 근무시간인지 평가 (장시간 근무는 감점)
  2. 급여: 최저임금 대비 수준, 경력 대비 적정성을 객관적으로 평가
  3. 건강: 질병과 업무의 신체적 부담을 면밀히 분석 (예: 요통 환자에게 중노동은 큰 감점)
  4. 직업이력: 이전 직업과의 연관성, 기술 활용 가능성을 구체적으로 평가
  5. 출퇴근: 거리뿐 아니라 대중교통 접근성, 소요시간을 종합 고려

  **1. 일자리 리스트**
  각 일자리 정보의 나열 순서는 다음과 같아.
  '모집 직종', '채용공고 제목', '기업명', '고용형태', '급여 정보', '근무 시간', '우대 조건', '근무지 주소', '위도', '경도', '인근 전철역'
  ('-'는 정보가 없는 공백란)
  
  {{JOB_LIST}}
  
  **2. 사용자 정보**
  - 생년월일: {{AGE}}
  - 주소: {{ADDR}}
  - 성별: {{GENDER}}
  - 직업: {{OCCUPATION}}
  - 보유 질병: {{DISEASE}}
  - 사용자 입력 질병: {{CUSTOM_DISEASE}}
  
  **3. 평가 방법**
  각 일자리에 대해 100점 만점 기준으로 적합도 점수(score)를 계산하고, 
  근무 시간(reason_working), 급여 수준(reason_salary), 건강상태 적합성(reason_disease), 
  직업 이력 적합성(reason_occupation), 출근 용이성(reason_addr)에 대해 
  각각 구체적이고 객관적으로 설명한 뒤, 가장 적합한 상위 30개를 추천해줘.
  
  ⚠️ 중요: 동일한 일자리(같은 기업의 같은 직종)를 중복으로 추천하지 마세요!

  **4. 응답 형식 (JSON Array를 String으로, 마크다운 형식 사용 금지)**
  
  ⚠️ 중요: 각 필드는 일자리 리스트에서 정확한 순서대로 매핑해야 합니다!
  예를 들어, 리스트가 "간호조무사", "병원 간호 업무", "예쁜현의원", ... 순서라면:
  - job_task = "간호조무사" (1번째 항목 = 모집 직종)
  - job_title = "병원 간호 업무" (2번째 항목 = 채용공고 제목)
  - job_desc = "예쁜현의원" (3번째 항목 = 기업명)
  
  절대로 job_task에 기업명을 넣거나, job_desc에 모집 직종을 넣지 마세요!
  
  [
    {
      "score": 93,
      "reason_working": "근무 시간의 추천도를 한 줄 이내로 설명하며, ~니다 형식으로 말을 마칠 것",
      "reason_salary": "급여 수준의 추천도를 한 줄 이내로 설명하며, ~니다 형식으로 말을 마칠 것",
      "reason_disease": "건강 상태와 추천업무의 적합성을 두 줄 이내로 설명하며, ~니다 형식으로 말을 마칠 것",
      "reason_occupation": "직업 이력과 추천 업무의 적합성을 두 줄 이내로 설명하며, ~니다 형식으로 말을 마칠 것",
      "reason_addr": "주거지에서 추천 업무지로의 출근 용이성을 두 줄 이내로 설명하며, ~니다 형식으로 말을 마칠 것",
      "job_task": "일자리 리스트의 1번째 항목 (모집 직종, 예: 간호조무사)",
      "job_title": "일자리 리스트의 2번째 항목 (채용공고 제목, 예: 병원 간호 업무)",
      "job_desc": "일자리 리스트의 3번째 항목 (기업명, 예: 예쁜현의원)",
      "job_salary": "일자리 리스트의 5번째 항목 (급여 정보)",
      "job_work_hours": "일자리 리스트의 6번째 항목 (근무 시간)",
      "job_address": "일자리 리스트의 8번째 항목 (근무지 주소)",
      "job_latitude": "일자리 리스트의 9번째 항목 (위도, 숫자만)",
      "job_longitude": "일자리 리스트의 10번째 항목 (경도, 숫자만)",
      "job_nearby_subway": "일자리 리스트의 11번째 항목 (인근 전철역)"
    }
  ]

---
# Development environment
spring:
  config:
    activate:
      on-profile: dev

---
# Staging environment
spring:
  config:
    activate:
      on-profile: stage

---
# Production environment
spring:
  config:
    activate:
      on-profile: prod

  # If you do not want property defaults to be applied you can set spring.devtools.add-properties to false in your application.properties.
  devtools:
    add-properties: false
    restart:
      enabled: false


decorator:
  datasource:
    p6spy:
      enable-logging: false

# ── H2 콘솔 활성화

